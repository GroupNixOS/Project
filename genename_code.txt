#load libraries
library(data.table)

#load data file and gene name file
mapping_data <- read.csv("C:/Users/cerih/gproject/group_project_data_2024 (1)/mart_export (1).txt", header = FALSE, sep = ",")
data <- read.table("C:/Users/cerih/gproject/group_project_data_2024 (1)/data_columns.txt", col.names = c('chromosome', 'position'), sep = ' ')

#data frame rows
matched_genes <- character(nrow(data))

# repeat at each position in the file
for (i in 1:nrow(data)) {
  # Find the matching positions
  interval_index <- which(data$position[i] >= mapping_data$V2 & data$position[i] <= mapping_data$V3)
  
  # If match found, assign the corresponding gene name
  if (length(interval_index) > 0) {
    matched_genes[i] <- mapping_data$V1[interval_index[1]]
  } else {
    matched_genes[i] <- NA  # No interval found, assign NA
  }
}

# Add the matched gene names to the data
data$matched_gene_name <- matched_genes

#save
write.csv(data, "gene_names.csv")
